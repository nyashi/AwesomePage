<html>
<head>
	<title>Contrato de venta de alma por novia bonita</title>
        <link rel="stylesheet" type="text/css" href="contrato.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.5.0-alpha1/html2canvas.min.js"></script>
        <script>
function dibujarFirma(id) {
	// Obtener el input y el elemento padre
	var input = document.querySelector("#" + id);
	var padre = input.parentNode;

	// Crear un elemento canvas para dibujar la firma
	var canvas = document.createElement("canvas");
	var ctx = canvas.getContext("2d");

	// Asignar el mismo ancho y alto que el input
	canvas.width = input.offsetWidth;
	canvas.height = input.offsetHeight;

	// Agregar el canvas al elemento padre y ocultar el input
	padre.replaceChild(canvas, input);
	input.style.display = "none";
        canvas.addEventListener("touchmove", function(e) {
		// Obtener la posición del dedo
		var x = e.targetTouches[0].pageX - canvas.offsetLeft;
		var y = e.targetTouches[0].pageY - canvas.offsetTop;

		// Dibujar una linea desde la posición anterior hasta la posición actual del dedo
		ctx.beginPath();
		ctx.moveTo(canvas.touchX, canvas.touchY);
		ctx.lineTo(x, y);
		ctx.stroke();

		// Guardar la posición actual del dedo como la posición anterior para la próxima iteración
		canvas.touchX = x;
		canvas.touchY = y;
	});
        canvas.addEventListener("touchend", function(e) {
		canvas.touchX = e.changedTouches[0].pageX - canvas.offsetLeft;
		canvas.touchY = e.changedTouches[0].pageY - canvas.offsetTop;
	});
	// Manejar el evento mousemove del canvas para dibujar la firma
	canvas.addEventListener("mousemove", function(e) {
		// Obtener la posición del cursor
		var x = e.offsetX;
		var y = e.offsetY;

		// Dibujar una linea desde la posición anterior hasta la posición actual del cursor
		ctx.beginPath();
		ctx.moveTo(canvas.mouseX, canvas.mouseY);
		ctx.lineTo(x, y);
		ctx.stroke();

		// Guardar la posición actual del cursor como la posición anterior para la próxima iteración
		canvas.mouseX = x;
		canvas.mouseY = y;
	});

	// Manejar el evento mousedown del canvas para guardar la posición inicial del cursor
	canvas.addEventListener("mousedown", function(e) {
		canvas.mouseX = e.offsetX;
		canvas.mouseY = e.offsetY;
	});
}
</script>

</head>
<body>
        <div class="contrato" id="contrato">
	<h1>Contrato de venta de alma por novia bonita</h1>
	<p>Entre yo, <input type="text" name="vendedor" placeholder="nombre del vendedor">, como vendedor, y <input type="text" name="comprador" placeholder="nombre del comprador">, como comprador, acordamos lo siguiente:</p>
	<ol>
		<li>Yo, el vendedor, vendo mi alma al comprador a cambio de una novia bonita.</li>
		<li>El comprador se compromete a proporcionar una novia bonita de acuerdo a sus propias definiciones de belleza.</li>
		<li>El vendedor se compromete a transferir la propiedad de su alma al comprador una vez que se haya cumplido el pago.</li>
		<li>El comprador se compromete a respetar los derechos y libertades del vendedor mientras este viva, siempre y cuando el vendedor cumpla con sus obligaciones en este contrato.</li>
		<li>El vendedor renuncia a cualquier derecho o claim sobre su alma una vez que se haya transferido la propiedad al comprador.</li>
		<li>Este contrato es válido por toda la eternidad y no puede ser revocado por ninguna de las partes involucradas.</li>
	</ol>
	<p>Firmado por ambas partes en <input type="date" name="fecha">.</p>
	<p>
		Lea nuestros <a href="#" onclick="confirm('Términos y condiciones: Este contrato es válido por toda la eternidad y no puede ser revocado por ninguna de las partes involucradas. El vendedor renuncia a cualquier derecho o claim sobre su alma una vez que se haya transferido la propiedad al comprador. El comprador se compromete a respetar los derechos y libertades del vendedor mientras este viva, siempre y cuando el vendedor cumpla con sus obligaciones en este contrato.')">términos y condiciones</a> antes de firmar.
	</p>
	<p>Firma del vendedor: <input type="text" id="firma_vendedor" name="firma_vendedor" placeholder="firma del vendedor"></p>
	<p>Firma del comprador: <input type="text" id="firma_comprador" name="firma_comprador" placeholder="firma del comprador"></p>
        </div>
        <button onclick="dibujarFirma('firma_vendedor')">Dibujar firma vendedor</button>
        <button onclick="dibujarFirma('firma_comprador')">Dibujar firma comprador</button>
        <button onclick="descargarContrato()">Descargar contrato</button>


</body>
<script>
function descargarContrato() {
	// Ocultar el botón de descargar contrato
	document.querySelector("button").style.display = "none";

        
	// Recorrer todos los input del formulario y obtener su valor y elemento padre
	document.querySelectorAll("input").forEach(function(input) {
		var valor = document.querySelector("input").value;
		var padre = document.querySelector("input").parentNode;

		// Crear una nueva cadena de texto que sea igual al contenido del elemento padre, reemplazando el input por su valor
		var nuevoTexto = padre.innerHTML.replace(input.outerHTML, valor);

		// Reemplazar el contenido del elemento padre por la nueva cadena de texto
		padre.innerHTML = nuevoTexto;
	});
        var canvasList = document.querySelectorAll(".contrato canvas");

	// Recorrer cada canvas y reemplazarlo por una imagen con la imagen del canvas
	canvasList.forEach(function(can) {
		// Obtener la imagen del canvas en formato base64
                var canvas=document.querySelector(".contrato canvas");
		var imagen = canvas.toDataURL();

		// Crear una imagen con el atributo src establecido con la imagen en formato base64
		var img = document.createElement("img");
		img.src = imagen;

		// Reemplazar el canvas por la imagen
		canvas.parentNode.replaceChild(img, canvas);
	});
	// Crear un elemento canvas para dibujar el contrato
	var canvas = document.createElement("canvas");
	var ctx = canvas.getContext("2d");

	// Obtener la altura y anchura del contenido del contrato
	var element = document.getElementById("contrato");
	var rect = element.getBoundingClientRect();
	canvas.width = rect.width;
	canvas.height = rect.height;

	// Dibujar el contenido del contrato en el canvas
	html2canvas(element).then(function(canvas) {
		// Mostrar el botón de descargar contrato de nuevo
		document.querySelector("button").style.display = "block";

		// Descargar la imagen del contrato
		var link = document.createElement("a");
		link.download = "contrato.png";
		link.href = canvas.toDataURL();
		link.click();
	});
}

</script>
</html>
